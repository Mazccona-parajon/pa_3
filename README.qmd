---
title: Programming assignment 3
format: gfm
date: last-modified
date-format: iso
---
```{r}
#| label: setup

# install.packages(c("tidyverse"))  # run once if needed

library(tidyverse)

# Path to the CSV created by your Praat script

dat <- read_csv("data/vowel_data.csv", show_col_types = FALSE)

# Peek at structure

glimpse(dat)

# Make sure expected columns exist:

# id, item, vowel, language, f1_cent, f2_cent, tl, f1_20...f2_80

stopifnot(all(c("id","item","vowel","language","f1_cent","f2_cent","tl") %in% names(dat)))

# Optional: order vowels (edit to your inventory)

dat <- dat %>%
mutate(
vowel = factor(vowel),
language = factor(language)
)

#| label: descriptives
descriptives <- dat %>%
group_by(language, vowel) %>%
summarise(
n        = n(),
mean_f1  = mean(f1_cent, na.rm = TRUE),
sd_f1    = sd(f1_cent, na.rm = TRUE),
se_f1    = sd_f1 / sqrt(n),
mean_f2  = mean(f2_cent, na.rm = TRUE),
sd_f2    = sd(f2_cent, na.rm = TRUE),
se_f2    = sd_f2 / sqrt(n),
mean_tl  = mean(tl, na.rm = TRUE),
sd_tl    = sd(tl, na.rm = TRUE),
se_tl    = sd_tl / sqrt(n),
.groups = "drop"
)
```


```{r}
ggplot(dat, aes(x = vowel, y = f1_cent, fill = language)) +
  geom_boxplot() +
  labs(
    title = "Distribution of Mean F1 by Vowel and Language",
    x = "Vowel",
    y = "Mean F1 (Hz)",
    fill = "Language"
  ) +
  theme_minimal()
```

```{r}
ggplot(dat, aes(x = vowel, y = f2_cent, fill = language)) +
  geom_boxplot() +
  labs(
    title = "Distribution of Mean F2 by Vowel and Language",
    x = "Vowel",
    y = "Mean F2 (Hz)",
    fill = "Language"
  ) +
  theme_minimal()
```
```{r}
ggplot(dat, aes(x = vowel, y = tl, fill = language)) +
  geom_boxplot() +
  labs(
    title = "Distribution of tl by Vowel and Language",
    x = "Vowel",
    y = "tl (Hz)",
    fill = "Language"
  ) +
  theme_minimal()
```
```{r}
library(ggplot2)

ggplot(dat, aes(x = f2_cent, y = f1_cent, color = language, label = vowel)) +
  # Plot each token as a point
  geom_point(alpha = 0.6, size = 3) +
  # Add vowel labels (optional)
  geom_text(vjust = -0.7, size = 3) +
  # Invert axes to match standard vowel space
  scale_x_reverse() +
  scale_y_reverse() +
  labs(
    title = "Spectral Centroids in F1â€“F2 Vowel Space",
    x = "F2 (Hz)",
    y = "F1 (Hz)",
    color = "Language"
  ) +
  theme_minimal() +
  theme(
    text = element_text(size = 12),
    legend.position = "top"
  )
```

